{"title":"Análisis Multivariable para Procedimientos de Control Estadístico de Procesos Fisicoquímicos","markdown":{"yaml":{"title":"Análisis Multivariable para Procedimientos de Control Estadístico de Procesos Fisicoquímicos"},"headingText":"¿Cómo, por qué, para qué y de dónde surge el análisis multivariable?","containsRefs":false,"markdown":"\n\n\nLos procesos fisicoquímicos son, por naturaleza, **multivariables**.\n\nPara el lector que busca comprender qué es realmente el *análisis multivariable* aplicado al proceso industrial, es necesario considerar antes algo mucho más fundamental.\n\nUn fenómeno multivariable **no vive en las variables**. \\\nVive en la **estructura de covarianza** que las conecta.\n\nEsto puede sonar extraño al inicio, pero la realidad (y por tanto el control) de un proceso multivariable **no reside en las variables individuales**, sino en el **subespacio** que estas conforman.\n\nEse subespacio es un lugar físico e intelectual al mismo tiempo.\n\nNo se observa directamente con los ojos, sino que se reconstruye con la mente y con matemáticas. Las variables fisicoquímicas, cuando se capturan como *datos*, no son el fenómeno en sí: son manifestaciones parciales de una expresión más esencial, una estructura que filtra la confusión para revelar significado.\n\nEse significado solo puede encontrarse en el subespacio que contiene la expresión mínima y fundamental del objeto central que es el que en realidad se analiza y el que más interesa, porque es el que está en el fondo del asunto: **el grado de libertad**.\n\nUn grado de libertad hace tres cosas esenciales:\n\n1.  Contiene la variación natural del proceso\n\n2.  La separa en componentes independientes\n\n3.  Nos muestra cómo se comporta el sistema\n\nUn proceso real no tiene un solo grado de libertad.\n\nEl subespacio contiene varios. Algunos son indispensables; otros, irrelevantes. La diferencia es crucial: los principales contienen la información esencial para comprender, diagnosticar y decidir; el resto es redundancia o ruido.\n\nEse subespacio tiene nombre. \\\nTiene valores. \\\nY tiene vectores.\n\nEs el **subespacio eigen**.\n\nEl análisis multivariable con base científica aplicado a procesos industriales **comienza formalmente ahí**.\n\nY de eso es exactamente de lo que hablaremos en este sitio.\n\nLe damos la bienvenida.\n\n### Vayamos a los detalles\n\nEl control estadístico multivariable (MSPC) difiere del control univariable tradicional (SPC).\n\nNo es “mejor” ni “peor”; es **conceptualmente distinto** y responde a una lógica diferente.\n\n### Una analogía simple\n\nUn procedimiento de control **univariable** puede compararse con un **detector de humo**:\\\nindica que el fuego existe, pero lo hace **después** de que la ignición ya ocurrió.\n\nUn procedimiento de control **multivariable** es más parecido a un **detector infrarrojo de temperatura**:\\\ndetecta incrementos simultáneos en distintos puntos **antes** de que se alcance el punto de ignición.\n\nAmbos enfoques son útiles.\n\nLa diferencia es que el segundo detecta cambios y tendencias más rápido porque contiene y procesa mucha más información. ¿Cómo?\n\n**Analiza las interacciones internas a partir de la covarianza del sistema**, mientras que el primero las ignora. Nunca las toca.\n\nPor ello, el análisis multivariable es **más sensible e informativo**, especialmente para procesos fisicoquímicos complejos.\n\n## Fluctuación, estructura y control\n\nLos datos multivariables **siempre exhiben fluctuaciones interconectadas**.\n\nPara construir procedimientos de control estadísticamente legítimos, existe **una sola pregunta analítica con validez científica**:\n\n**¿Esas fluctuaciones están estructuradas en grados de libertad dominantes, o son esencialmente ruido?**\n\nLa respuesta la proporciona el **análisis eigen**.\n\nY la base es el álgebra lineal. Todo el análisis y la tecnología para extraer las respuestas están ahí.\n\nLo siguiente que veremos puede sonar \"teórico\" pero en realidad, es la base fundamental del análisis de datos y depende de la identificación de **los grados de libertad** de un sistema multivariable que pudiese o no contener información.\n\nCada grado de libertad queda descrito como un valor eigen $\\lambda_i$ que cuantifica la varianza asociada a su respectivo grado de libertad independiente del sistema, mientras que los vectores eigen correspondientes definen las direcciones ortogonales de fluctuación en el espacio de las variables originales.\n\nLas expresiones formales que definen y explican estos conceptos adquieren la forma del álgebra lineal y todo comienza con la matriz de nuestros de datos de proceso, $\\boldsymbol{X}$ y su respectiva matriz de covarianza $\\boldsymbol{\\Sigma}$, descompuesta en sus vectores eigen $\\boldsymbol{P}$ y sus grados de libertad $\\boldsymbol{\\Lambda}$.\n\n#### $$\\boldsymbol{\\Sigma} = \\mathbf{P}\\boldsymbol{\\Lambda}\\mathbf{P}^\\top$$\n\nDigamos que $\\mathbf{X} \\in \\mathbb{R}^{n \\times m}$ es nuestra matriz de datos multivariables de calibración en Fase I, centrada y escalada.\n\nLuego, tenemos su matriz de covarianzas:\n\n#### $$\\boldsymbol{\\Sigma} = \\frac{1}{n-1}\\mathbf{X}^\\top \\mathbf{X}$$\n\nPor eso el análisis eigen consiste simplemente en resolver la ecuación característica:\n\n#### $$\\det(\\boldsymbol{\\Sigma} - \\lambda \\mathbf{I}) = 0$$\n\nLa física clásica nos enseñó que esta determinante nos entrega las raíces $\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_p$ que definen la cantidad y magnitud de cada uno de los modos elementales de fluctuación material de nuestro proceso, siempre y cuando se encuentre en el equilibrio. Esto es simple de entender porque se supone que esa es la condición de nuestro proceso cuando está bajo control y el producto es conforme.\n\nEn términos prácticos: podremos tener 5, 50 o 500 variables o más en nuestro proceso, (inclusive autocorrelacionadas en el tiempo) pero si la información está intercorrelacionada, o si fuera redundante o multicolineal, no tendremos que descartar nada porque con solo un puñado de modos elementales obtendremos toda la información que necesitamos para establecer el control estadístico del proceso con la mayor sensibilidad posible.\n\nEsto es justo lo que nos revela la distribución de todas las variaciones: el 100% de toda la fluctuación está repartida entre cada uno de los grados de libertad.\n\n¿Cómo procedemos?\n\n## Dos caminos posibles\n\nEl resultado del análisis eigen permite decidir entre dos enfoques claramente diferenciados:\n\n### 1. Metodologías trazables y validables\n\nLo primero es la proyección de una observación $\\mathbf{x}$ sobre el subespacio definido por los modos dominantes. Al proyectar nuestras variables originales al subespacio ocupado por los grados de libertad, aparece la definición de una distancia estadística cuadrática conocida popularmente como Mahalanobis:\n\n#### $$T^2 = \\mathbf{x}^\\top \\boldsymbol{\\Sigma}^{-1} \\mathbf{x}$$\n\nTambién se representa con la letra D y en algunos textos de quimiometría se escribe como h0. Es un escalar muy popular.\n\nEste tipo de escalar nos permite medir la desviación global del sistema respecto a su estado de equilibrio, ubicado en el centro de la distribución de probabilidad, pero que ahora es multivariable y con forma elíptica (en el contexto univariable es la clásica curva gaussiana). Es el mismo origen en el espacio euclidiano multidimensional, pero que al escalarlo y maniobrar con la rotación de los ejes, tansitamos al espacio donde encontramos a los grados de libertad que caracterizan a nuestro sistema y ahí es donde fluctúan con independencia. El sistema no cambió. Lo único que cambió fue nuestro ángulo de observación. Y toda la información de fluctuación se conserva. Nada se pierde. Pero todo se simplifica.\n\nPor eso el desarrollo de metodologías estocásticas multivariables para control de procesos fisicoquímicos se fundamentan en:\n\n-   distancias estadísticas,\n\n-   regiones de probabilidad con límites naturales,\n\n-   pruebas de hipótesis falsables,\n\n-   control explícito del error tipo I.\n\nEste enfoque es compatible con **control estadístico multivariable de procesos** y validación científica formal porque toda su matemática es transparente y auditable.\n\n### 2. Modelado algorítmico sin trazabilidad\n\nLo segundo es recurrir a algoritmos de *machine learning* para modelar patrones locales de la fluctuación, pero **sin ninguna garantía de trazabilidad matemática ni validación estadística formal**. El aprendizaje de máquina no constituye una metodologóia de validación porque para efectos de trazabilidad, es una \"caja negra\".\n\nAmbos caminos son legítimos, pero **no persiguen el mismo objetivo**.\n\n## Madurez del proceso y validez estadística\n\nBajo condiciones de normalidad multivariable y estabilidad del proceso, el estadístico $T^2$ sigue una distribución conocida, lo que permite establecer **regiones elípticas de probabilidad** y formular pruebas de hipótesis falsables para el control del error tipo I.\n\n#### $$H_0: T^2 \\le T^2_{\\text{crit}} \\qquad H_1: T^2 > T^2_{\\text{crit}}$$\n\nEste procedimiento exige visualizar la normalidad multivariable en la forma de su distribución de probabilidad que emerge de manera natural: la elipse (o elipsoide).\n\nHaz clic sobre la siguiente imagen, rótala , muévela, haz scroll y acércate y aléjate y explora.\n\n```{r}\n\n#| echo: false\n#| warning: false\n#| message: false\n#| results: hide\n#| cache: false\n#| fig-cap: \"Región elipsoidal de probabilidad asociada al estadístico T^2.\"\n\nlibrary(rgl)\nlibrary(MASS)\nlibrary(car)  # para ellipse3d\n\n# --- Matriz de covarianzas ---\nSigma <- matrix(c(10, 3, 0,\n                  3,  2, 0,\n                  0,  0, 1), 3, 3)\n\n# --- Media y datos simulados ---\nMean <- 1:3\nset.seed(123)\nx <- MASS::mvrnorm(1000, Mean, Sigma)\n\n# --- Abrir ventana rgl embebida ---\nopen3d()\nbg3d(\"white\")\n\n# --- Nube de datos ---\nplot3d(x,\n       col  = \"gray40\",\n       size = 4,\n       box  = FALSE,\n       xlab = \"\",\n       ylab = \"\",\n       zlab = \"\",)\n\n# --- Elipsoide de confianza (Hotelling T^2 implícito) ---\nell <- ellipse3d(Sigma, centre = Mean, level = 0.95)\nshade3d(ell, col = \"#265129\", alpha = 0.35)\n\n# --- Ejes y aspecto ---\naxes3d()\naspect3d(1, 1, 1)\n\n# --- Etiquetas de ejes sin acentos ni saltos de linea ---\ntitle3d(\n  xlab = \"Eigen 1\",\n  ylab = \"Eigen 2\",\n  zlab = \"Eigen 3\",\n  main = \"Region elipsoidal de probabilidad Hotelling T2 (95%)\"\n)\n\n# --- Embebido para Quarto ---\nrglwidget()\n```\n\nCada punto es una observación en una tabla de datos multivariables, pero nuestro procedimiento colapsa todos los datos en puntos que se ubican en coordenadas que obedecen a los grados de libertad eigen dominantes. Cada grado de libertad eigen representa conjuntos de variables.\n\nLa superficie translúcida representa la región de probabilidad del 95% asociada al estadístico T².\n\nPor eso todos los puntos que están dentro de la elipse son observaciones conformes y las que están fuera de ella son no conformidades en la región $\\alpha = 0.05$.\n\nLa idea es equivalente a un gráfico de control univariable. Es solo que en este formato y con esta metodología, cada punto puede contener docenas o cientos de variables, todas condensadas en un punto en el espacio.\n\nLa elipse no es una elección gráfica: es la manifestación directa de la estructura espectral de la matriz de covarianzas. Sin modos eigen dominantes, esta región no existe.\n\nPor eso, si el cliente requiere la **primera vía** (validación científica de sus datos multivariables), pero el análisis eigen revela **ausencia de modos dominantes**, ello indica que:\n\n-   el proceso aún no ha alcanzado la **madurez y estabilidad necesarias**, y\n\n-   **no existen grados de libertad mínimos suficientes** para una validación estadística legítima.\n\nPretender control estadístico multivariable bajo condiciones no estructuradas **no es válido**.\n\n## ¿Qué se busca confirmar?\n\nSi su objetivo es implementar un procedimiento de control multivariable fundamentado en la física del sistema, es indispensable confirmar:\n\n1.  **Si existen grados de libertad dominantes**, y\n\n2.  **Si existen en cantidad mínima aceptable**.\n\n### ¿Por qué?\n\nPorque:\n\n**Sin grados de libertad dominantes, el control estadístico multivariable no es ni física ni matemáticamente posible.**\n\n**Y sin control estadístico multivariable a partir de un proceo maduro y estable, no existe validación falsable del error tipo I.**\n\nSi los datos carecen de estructura espectral dominante, la única alternativa razonable es modelar la fluctuación **localmente**, mediante algoritmos de machine learning. La búsqueda de algoritmos útiles es laboriosa y toma tiempo porque requiere comparaciones empíricas, a prueba y error bajo criterios arbitrarios o en el mejor de los casos, de validaciones cruzadas, hasta encontrar alguno que pudiera modelar el ruido generalizado. En todos los casos, la selección final depende no solo de las pruebas, sino del criterio subjetivo del analista. Por eso las metodologías con algoritmos de machine learning difícilmente son reproducibles.\n\nNaturalmente, la seria desventaja es que en estos casos no es posible ni factible establecer procedimientos de control a partir de validación estadística.\n\n## Beneficio para el cliente\n\nCuando los datos fisicoquímicos multivariables **sí revelan estructura interna**, el beneficio es doble:\n\n1.  Es posible implementar control estadístico multivariable **de alta sensibilidad**.\n\n2.  Se habilita la **identificación de causas raíz**.\n\n¿Por qué?\n\nPorque la señal multivariable está compuesta por **señales univariables interconectadas**.\\\nCuando se detecta una desviación multivariable, **al menos una o dos variables** son responsables.\\\nAsí, aunque sean docenas o incluso cientos, la descomposición quimiométrica de la señal permite **identificarlas y cuantificarlas**. Una por una. Con un clic.\n\nPor eso el desarrollo de metodologías por estadística multivariable a partir de la descomposición espectral eigen para identificación de grados de libertad no solo es reproducible, sino trazable.\n\nPor eso es científica.\n\n## Nuestra labor\n\nNuestra labor es simple y fundamental:\n\n**Determinar si un proceso fisicoquímico es maduro, estable y estadísticamente validable.**\n\n¿Cómo lo hacemos?\n\n**Identificando los modos elementales de fluctuación que emergen a partir del análisis eigen de sus datos fisicoquímicos multivariables.**\n\nEl objetivo final es contar con un procedimiento de control que permita detectar desviaciones tempranas y en cuestión de segundos, conocer las causas.\n\nTodo inicia con el análisis eigen que identifica los grados de libertad en sus datos.\n\nY todo termina con el diagnóstico de causas-raíz. Con solo un clic.\n","srcMarkdownNoYaml":"\n\n## ¿Cómo, por qué, para qué y de dónde surge el análisis multivariable?\n\nLos procesos fisicoquímicos son, por naturaleza, **multivariables**.\n\nPara el lector que busca comprender qué es realmente el *análisis multivariable* aplicado al proceso industrial, es necesario considerar antes algo mucho más fundamental.\n\nUn fenómeno multivariable **no vive en las variables**. \\\nVive en la **estructura de covarianza** que las conecta.\n\nEsto puede sonar extraño al inicio, pero la realidad (y por tanto el control) de un proceso multivariable **no reside en las variables individuales**, sino en el **subespacio** que estas conforman.\n\nEse subespacio es un lugar físico e intelectual al mismo tiempo.\n\nNo se observa directamente con los ojos, sino que se reconstruye con la mente y con matemáticas. Las variables fisicoquímicas, cuando se capturan como *datos*, no son el fenómeno en sí: son manifestaciones parciales de una expresión más esencial, una estructura que filtra la confusión para revelar significado.\n\nEse significado solo puede encontrarse en el subespacio que contiene la expresión mínima y fundamental del objeto central que es el que en realidad se analiza y el que más interesa, porque es el que está en el fondo del asunto: **el grado de libertad**.\n\nUn grado de libertad hace tres cosas esenciales:\n\n1.  Contiene la variación natural del proceso\n\n2.  La separa en componentes independientes\n\n3.  Nos muestra cómo se comporta el sistema\n\nUn proceso real no tiene un solo grado de libertad.\n\nEl subespacio contiene varios. Algunos son indispensables; otros, irrelevantes. La diferencia es crucial: los principales contienen la información esencial para comprender, diagnosticar y decidir; el resto es redundancia o ruido.\n\nEse subespacio tiene nombre. \\\nTiene valores. \\\nY tiene vectores.\n\nEs el **subespacio eigen**.\n\nEl análisis multivariable con base científica aplicado a procesos industriales **comienza formalmente ahí**.\n\nY de eso es exactamente de lo que hablaremos en este sitio.\n\nLe damos la bienvenida.\n\n### Vayamos a los detalles\n\nEl control estadístico multivariable (MSPC) difiere del control univariable tradicional (SPC).\n\nNo es “mejor” ni “peor”; es **conceptualmente distinto** y responde a una lógica diferente.\n\n### Una analogía simple\n\nUn procedimiento de control **univariable** puede compararse con un **detector de humo**:\\\nindica que el fuego existe, pero lo hace **después** de que la ignición ya ocurrió.\n\nUn procedimiento de control **multivariable** es más parecido a un **detector infrarrojo de temperatura**:\\\ndetecta incrementos simultáneos en distintos puntos **antes** de que se alcance el punto de ignición.\n\nAmbos enfoques son útiles.\n\nLa diferencia es que el segundo detecta cambios y tendencias más rápido porque contiene y procesa mucha más información. ¿Cómo?\n\n**Analiza las interacciones internas a partir de la covarianza del sistema**, mientras que el primero las ignora. Nunca las toca.\n\nPor ello, el análisis multivariable es **más sensible e informativo**, especialmente para procesos fisicoquímicos complejos.\n\n## Fluctuación, estructura y control\n\nLos datos multivariables **siempre exhiben fluctuaciones interconectadas**.\n\nPara construir procedimientos de control estadísticamente legítimos, existe **una sola pregunta analítica con validez científica**:\n\n**¿Esas fluctuaciones están estructuradas en grados de libertad dominantes, o son esencialmente ruido?**\n\nLa respuesta la proporciona el **análisis eigen**.\n\nY la base es el álgebra lineal. Todo el análisis y la tecnología para extraer las respuestas están ahí.\n\nLo siguiente que veremos puede sonar \"teórico\" pero en realidad, es la base fundamental del análisis de datos y depende de la identificación de **los grados de libertad** de un sistema multivariable que pudiese o no contener información.\n\nCada grado de libertad queda descrito como un valor eigen $\\lambda_i$ que cuantifica la varianza asociada a su respectivo grado de libertad independiente del sistema, mientras que los vectores eigen correspondientes definen las direcciones ortogonales de fluctuación en el espacio de las variables originales.\n\nLas expresiones formales que definen y explican estos conceptos adquieren la forma del álgebra lineal y todo comienza con la matriz de nuestros de datos de proceso, $\\boldsymbol{X}$ y su respectiva matriz de covarianza $\\boldsymbol{\\Sigma}$, descompuesta en sus vectores eigen $\\boldsymbol{P}$ y sus grados de libertad $\\boldsymbol{\\Lambda}$.\n\n#### $$\\boldsymbol{\\Sigma} = \\mathbf{P}\\boldsymbol{\\Lambda}\\mathbf{P}^\\top$$\n\nDigamos que $\\mathbf{X} \\in \\mathbb{R}^{n \\times m}$ es nuestra matriz de datos multivariables de calibración en Fase I, centrada y escalada.\n\nLuego, tenemos su matriz de covarianzas:\n\n#### $$\\boldsymbol{\\Sigma} = \\frac{1}{n-1}\\mathbf{X}^\\top \\mathbf{X}$$\n\nPor eso el análisis eigen consiste simplemente en resolver la ecuación característica:\n\n#### $$\\det(\\boldsymbol{\\Sigma} - \\lambda \\mathbf{I}) = 0$$\n\nLa física clásica nos enseñó que esta determinante nos entrega las raíces $\\lambda_1 \\ge \\lambda_2 \\ge \\dots \\ge \\lambda_p$ que definen la cantidad y magnitud de cada uno de los modos elementales de fluctuación material de nuestro proceso, siempre y cuando se encuentre en el equilibrio. Esto es simple de entender porque se supone que esa es la condición de nuestro proceso cuando está bajo control y el producto es conforme.\n\nEn términos prácticos: podremos tener 5, 50 o 500 variables o más en nuestro proceso, (inclusive autocorrelacionadas en el tiempo) pero si la información está intercorrelacionada, o si fuera redundante o multicolineal, no tendremos que descartar nada porque con solo un puñado de modos elementales obtendremos toda la información que necesitamos para establecer el control estadístico del proceso con la mayor sensibilidad posible.\n\nEsto es justo lo que nos revela la distribución de todas las variaciones: el 100% de toda la fluctuación está repartida entre cada uno de los grados de libertad.\n\n¿Cómo procedemos?\n\n## Dos caminos posibles\n\nEl resultado del análisis eigen permite decidir entre dos enfoques claramente diferenciados:\n\n### 1. Metodologías trazables y validables\n\nLo primero es la proyección de una observación $\\mathbf{x}$ sobre el subespacio definido por los modos dominantes. Al proyectar nuestras variables originales al subespacio ocupado por los grados de libertad, aparece la definición de una distancia estadística cuadrática conocida popularmente como Mahalanobis:\n\n#### $$T^2 = \\mathbf{x}^\\top \\boldsymbol{\\Sigma}^{-1} \\mathbf{x}$$\n\nTambién se representa con la letra D y en algunos textos de quimiometría se escribe como h0. Es un escalar muy popular.\n\nEste tipo de escalar nos permite medir la desviación global del sistema respecto a su estado de equilibrio, ubicado en el centro de la distribución de probabilidad, pero que ahora es multivariable y con forma elíptica (en el contexto univariable es la clásica curva gaussiana). Es el mismo origen en el espacio euclidiano multidimensional, pero que al escalarlo y maniobrar con la rotación de los ejes, tansitamos al espacio donde encontramos a los grados de libertad que caracterizan a nuestro sistema y ahí es donde fluctúan con independencia. El sistema no cambió. Lo único que cambió fue nuestro ángulo de observación. Y toda la información de fluctuación se conserva. Nada se pierde. Pero todo se simplifica.\n\nPor eso el desarrollo de metodologías estocásticas multivariables para control de procesos fisicoquímicos se fundamentan en:\n\n-   distancias estadísticas,\n\n-   regiones de probabilidad con límites naturales,\n\n-   pruebas de hipótesis falsables,\n\n-   control explícito del error tipo I.\n\nEste enfoque es compatible con **control estadístico multivariable de procesos** y validación científica formal porque toda su matemática es transparente y auditable.\n\n### 2. Modelado algorítmico sin trazabilidad\n\nLo segundo es recurrir a algoritmos de *machine learning* para modelar patrones locales de la fluctuación, pero **sin ninguna garantía de trazabilidad matemática ni validación estadística formal**. El aprendizaje de máquina no constituye una metodologóia de validación porque para efectos de trazabilidad, es una \"caja negra\".\n\nAmbos caminos son legítimos, pero **no persiguen el mismo objetivo**.\n\n## Madurez del proceso y validez estadística\n\nBajo condiciones de normalidad multivariable y estabilidad del proceso, el estadístico $T^2$ sigue una distribución conocida, lo que permite establecer **regiones elípticas de probabilidad** y formular pruebas de hipótesis falsables para el control del error tipo I.\n\n#### $$H_0: T^2 \\le T^2_{\\text{crit}} \\qquad H_1: T^2 > T^2_{\\text{crit}}$$\n\nEste procedimiento exige visualizar la normalidad multivariable en la forma de su distribución de probabilidad que emerge de manera natural: la elipse (o elipsoide).\n\nHaz clic sobre la siguiente imagen, rótala , muévela, haz scroll y acércate y aléjate y explora.\n\n```{r}\n\n#| echo: false\n#| warning: false\n#| message: false\n#| results: hide\n#| cache: false\n#| fig-cap: \"Región elipsoidal de probabilidad asociada al estadístico T^2.\"\n\nlibrary(rgl)\nlibrary(MASS)\nlibrary(car)  # para ellipse3d\n\n# --- Matriz de covarianzas ---\nSigma <- matrix(c(10, 3, 0,\n                  3,  2, 0,\n                  0,  0, 1), 3, 3)\n\n# --- Media y datos simulados ---\nMean <- 1:3\nset.seed(123)\nx <- MASS::mvrnorm(1000, Mean, Sigma)\n\n# --- Abrir ventana rgl embebida ---\nopen3d()\nbg3d(\"white\")\n\n# --- Nube de datos ---\nplot3d(x,\n       col  = \"gray40\",\n       size = 4,\n       box  = FALSE,\n       xlab = \"\",\n       ylab = \"\",\n       zlab = \"\",)\n\n# --- Elipsoide de confianza (Hotelling T^2 implícito) ---\nell <- ellipse3d(Sigma, centre = Mean, level = 0.95)\nshade3d(ell, col = \"#265129\", alpha = 0.35)\n\n# --- Ejes y aspecto ---\naxes3d()\naspect3d(1, 1, 1)\n\n# --- Etiquetas de ejes sin acentos ni saltos de linea ---\ntitle3d(\n  xlab = \"Eigen 1\",\n  ylab = \"Eigen 2\",\n  zlab = \"Eigen 3\",\n  main = \"Region elipsoidal de probabilidad Hotelling T2 (95%)\"\n)\n\n# --- Embebido para Quarto ---\nrglwidget()\n```\n\nCada punto es una observación en una tabla de datos multivariables, pero nuestro procedimiento colapsa todos los datos en puntos que se ubican en coordenadas que obedecen a los grados de libertad eigen dominantes. Cada grado de libertad eigen representa conjuntos de variables.\n\nLa superficie translúcida representa la región de probabilidad del 95% asociada al estadístico T².\n\nPor eso todos los puntos que están dentro de la elipse son observaciones conformes y las que están fuera de ella son no conformidades en la región $\\alpha = 0.05$.\n\nLa idea es equivalente a un gráfico de control univariable. Es solo que en este formato y con esta metodología, cada punto puede contener docenas o cientos de variables, todas condensadas en un punto en el espacio.\n\nLa elipse no es una elección gráfica: es la manifestación directa de la estructura espectral de la matriz de covarianzas. Sin modos eigen dominantes, esta región no existe.\n\nPor eso, si el cliente requiere la **primera vía** (validación científica de sus datos multivariables), pero el análisis eigen revela **ausencia de modos dominantes**, ello indica que:\n\n-   el proceso aún no ha alcanzado la **madurez y estabilidad necesarias**, y\n\n-   **no existen grados de libertad mínimos suficientes** para una validación estadística legítima.\n\nPretender control estadístico multivariable bajo condiciones no estructuradas **no es válido**.\n\n## ¿Qué se busca confirmar?\n\nSi su objetivo es implementar un procedimiento de control multivariable fundamentado en la física del sistema, es indispensable confirmar:\n\n1.  **Si existen grados de libertad dominantes**, y\n\n2.  **Si existen en cantidad mínima aceptable**.\n\n### ¿Por qué?\n\nPorque:\n\n**Sin grados de libertad dominantes, el control estadístico multivariable no es ni física ni matemáticamente posible.**\n\n**Y sin control estadístico multivariable a partir de un proceo maduro y estable, no existe validación falsable del error tipo I.**\n\nSi los datos carecen de estructura espectral dominante, la única alternativa razonable es modelar la fluctuación **localmente**, mediante algoritmos de machine learning. La búsqueda de algoritmos útiles es laboriosa y toma tiempo porque requiere comparaciones empíricas, a prueba y error bajo criterios arbitrarios o en el mejor de los casos, de validaciones cruzadas, hasta encontrar alguno que pudiera modelar el ruido generalizado. En todos los casos, la selección final depende no solo de las pruebas, sino del criterio subjetivo del analista. Por eso las metodologías con algoritmos de machine learning difícilmente son reproducibles.\n\nNaturalmente, la seria desventaja es que en estos casos no es posible ni factible establecer procedimientos de control a partir de validación estadística.\n\n## Beneficio para el cliente\n\nCuando los datos fisicoquímicos multivariables **sí revelan estructura interna**, el beneficio es doble:\n\n1.  Es posible implementar control estadístico multivariable **de alta sensibilidad**.\n\n2.  Se habilita la **identificación de causas raíz**.\n\n¿Por qué?\n\nPorque la señal multivariable está compuesta por **señales univariables interconectadas**.\\\nCuando se detecta una desviación multivariable, **al menos una o dos variables** son responsables.\\\nAsí, aunque sean docenas o incluso cientos, la descomposición quimiométrica de la señal permite **identificarlas y cuantificarlas**. Una por una. Con un clic.\n\nPor eso el desarrollo de metodologías por estadística multivariable a partir de la descomposición espectral eigen para identificación de grados de libertad no solo es reproducible, sino trazable.\n\nPor eso es científica.\n\n## Nuestra labor\n\nNuestra labor es simple y fundamental:\n\n**Determinar si un proceso fisicoquímico es maduro, estable y estadísticamente validable.**\n\n¿Cómo lo hacemos?\n\n**Identificando los modos elementales de fluctuación que emergen a partir del análisis eigen de sus datos fisicoquímicos multivariables.**\n\nEl objetivo final es contar con un procedimiento de control que permita detectar desviaciones tempranas y en cuestión de segundos, conocer las causas.\n\nTodo inicia con el análisis eigen que identifica los grados de libertad en sus datos.\n\nY todo termina con el diagnóstico de causas-raíz. Con solo un clic.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":false,"number-sections":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","author":{"name":"Q.I. Víctor Soto Del Toro"},"theme":"cosmo","page-layout":"full","number-depth":3,"smooth-scroll":true,"title":"Análisis Multivariable para Procedimientos de Control Estadístico de Procesos Fisicoquímicos"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}